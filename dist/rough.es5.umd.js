!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).rough=e()}(this,function(){"use strict";var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};function e(e,i){function s(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}var i="undefined"!=typeof self,s=function(){function t(t,e){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1},this.config=t||{},this.surface=e,this.config.options&&(this.defaultOptions=this._options(this.config.options))}return t.prototype._options=function(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions},t.prototype._drawable=function(t,e,i){return{shape:t,sets:e||[],options:i||this.defaultOptions}},t.prototype.getCanvasSize=function(){var t=function(t){return t&&"object"==typeof t&&t.baseVal&&t.baseVal.value?t.baseVal.value:t||100};return this.surface?[t(this.surface.width),t(this.surface.height)]:[100,100]},t.prototype.computePolygonSize=function(t){if(t.length){for(var e=t[0][0],i=t[0][0],s=t[0][1],r=t[0][1],n=1;n<t.length;n++)e=Math.min(e,t[n][0]),i=Math.max(i,t[n][0]),s=Math.min(s,t[n][1]),r=Math.max(r,t[n][1]);return[i-e,r-s]}return[0,0]},t.prototype.polygonPath=function(t){var e="";if(t.length){e="M"+t[0][0]+","+t[0][1];for(var i=1;i<t.length;i++)e=e+" L"+t[i][0]+","+t[i][1]}return e},t.prototype.computePathSize=function(t){var e=[0,0];if(i&&self.document)try{var s="http://www.w3.org/2000/svg",r=self.document.createElementNS(s,"svg");r.setAttribute("width","0"),r.setAttribute("height","0");var n=self.document.createElementNS(s,"path");n.setAttribute("d",t),r.appendChild(n),self.document.body.appendChild(r);var a=n.getBBox();a&&(e[0]=a.width||0,e[1]=a.height||0),self.document.body.removeChild(r)}catch(t){}var h=this.getCanvasSize();return e[0]*e[1]||(e=h),e},t.prototype.toPaths=function(t){for(var e=t.sets||[],i=t.options||this.defaultOptions,s=[],r=0,n=e;r<n.length;r++){var a=n[r],h=null;switch(a.type){case"path":h={d:this.opsToPath(a),stroke:i.stroke,strokeWidth:i.strokeWidth,fill:"none"};break;case"fillPath":h={d:this.opsToPath(a),stroke:"none",strokeWidth:0,fill:i.fill||"none"};break;case"fillSketch":h=this.fillSketch(a,i);break;case"path2Dfill":h={d:a.path||"",stroke:"none",strokeWidth:0,fill:i.fill||"none"};break;case"path2Dpattern":var o=a.size,p={x:0,y:0,width:1,height:1,viewBox:"0 0 "+Math.round(o[0])+" "+Math.round(o[1]),patternUnits:"objectBoundingBox",path:this.fillSketch(a,i)};h={d:a.path,stroke:"none",strokeWidth:0,pattern:p}}h&&s.push(h)}return s},t.prototype.fillSketch=function(t,e){var i=e.fillWeight;return i<0&&(i=e.strokeWidth/2),{d:this.opsToPath(t),stroke:e.fill||"none",strokeWidth:i,fill:"none"}},t.prototype.opsToPath=function(t){for(var e="",i=0,s=t.ops;i<s.length;i++){var r=s[i],n=r.data;switch(r.op){case"move":e+="M"+n[0]+" "+n[1]+" ";break;case"bcurveTo":e+="C"+n[0]+" "+n[1]+", "+n[2]+" "+n[3]+", "+n[4]+" "+n[5]+" ";break;case"qcurveTo":e+="Q"+n[0]+" "+n[1]+", "+n[2]+" "+n[3]+" ";break;case"lineTo":e+="L"+n[0]+" "+n[1]+" "}}return e.trim()},t}();function r(t,e){return t.type===e}var n={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:4,t:2,V:1,v:1,Z:0,z:0},a=function(){function t(t){this.COMMAND=0,this.NUMBER=1,this.EOD=2,this.segments=[],this.parseData(t),this.processPoints()}return t.prototype.tokenize=function(t){for(var e=new Array;""!==t;)if(t.match(/^([ \t\r\n,]+)/))t=t.substr(RegExp.$1.length);else if(t.match(/^([aAcChHlLmMqQsStTvVzZ])/))e[e.length]={type:this.COMMAND,text:RegExp.$1},t=t.substr(RegExp.$1.length);else{if(!t.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return console.error("Unrecognized segment command: "+t),[];e[e.length]={type:this.NUMBER,text:""+parseFloat(RegExp.$1)},t=t.substr(RegExp.$1.length)}return e[e.length]={type:this.EOD,text:""},e},t.prototype.parseData=function(t){var e=this.tokenize(t),i=0,s=e[i],a="BOD";for(this.segments=new Array;!r(s,this.EOD);){var h=void 0,o=new Array;if("BOD"===a){if("M"!==s.text&&"m"!==s.text)return void this.parseData("M0,0"+t);i++,h=n[s.text],a=s.text}else r(s,this.NUMBER)?h=n[a]:(i++,h=n[s.text],a=s.text);if(i+h<e.length){for(var p=i;p<i+h;p++){var l=e[p];if(!r(l,this.NUMBER))return void console.error("Parameter type is not a number: "+a+","+l.text);o[o.length]=+l.text}if("number"!=typeof n[a])return void console.error("Unsupported segment type: "+a);var u={key:a,data:o};this.segments.push(u),s=e[i+=h],"M"===a&&(a="L"),"m"===a&&(a="l")}else console.error("Path data ended before all parameters were found")}},Object.defineProperty(t.prototype,"closed",{get:function(){if(void 0===this._closed){this._closed=!1;for(var t=0,e=this.segments;t<e.length;t++){"z"===e[t].key.toLowerCase()&&(this._closed=!0)}}return this._closed},enumerable:!0,configurable:!0}),t.prototype.processPoints=function(){for(var t=null,e=[0,0],i=0;i<this.segments.length;i++){var s=this.segments[i];switch(s.key){case"M":case"L":case"T":s.point=[s.data[0],s.data[1]];break;case"m":case"l":case"t":s.point=[s.data[0]+e[0],s.data[1]+e[1]];break;case"H":s.point=[s.data[0],e[1]];break;case"h":s.point=[s.data[0]+e[0],e[1]];break;case"V":s.point=[e[0],s.data[0]];break;case"v":s.point=[e[0],s.data[0]+e[1]];break;case"z":case"Z":t&&(s.point=[t[0],t[1]]);break;case"C":s.point=[s.data[4],s.data[5]];break;case"c":s.point=[s.data[4]+e[0],s.data[5]+e[1]];break;case"S":s.point=[s.data[2],s.data[3]];break;case"s":s.point=[s.data[2]+e[0],s.data[3]+e[1]];break;case"Q":s.point=[s.data[2],s.data[3]];break;case"q":s.point=[s.data[2]+e[0],s.data[3]+e[1]];break;case"A":s.point=[s.data[5],s.data[6]];break;case"a":s.point=[s.data[5]+e[0],s.data[6]+e[1]]}"m"!==s.key&&"M"!==s.key||(t=null),s.point&&(e=s.point,t||(t=s.point)),"z"!==s.key&&"Z"!==s.key||(t=null)}},t}(),h=function(){function t(t){this._position=[0,0],this._first=null,this.bezierReflectionPoint=null,this.quadReflectionPoint=null,this.parsed=new a(t)}return Object.defineProperty(t.prototype,"segments",{get:function(){return this.parsed.segments},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"closed",{get:function(){return this.parsed.closed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"linearPoints",{get:function(){if(!this._linearPoints){for(var t=[],e=[],i=0,s=this.parsed.segments;i<s.length;i++){var r=s[i],n=r.key.toLowerCase();("m"!==n&&"z"!==n||(e.length&&(t.push(e),e=[]),"z"!==n))&&(r.point&&e.push(r.point))}e.length&&(t.push(e),e=[]),this._linearPoints=t}return this._linearPoints},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"first",{get:function(){return this._first},set:function(t){this._first=t},enumerable:!0,configurable:!0}),t.prototype.setPosition=function(t,e){this._position=[t,e],this._first||(this._first=[t,e])},Object.defineProperty(t.prototype,"position",{get:function(){return this._position},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this._position[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._position[1]},enumerable:!0,configurable:!0}),t}(),o=function(){function t(t,e,i,s,r,n){if(this._segIndex=0,this._numSegs=0,this._rx=0,this._ry=0,this._sinPhi=0,this._cosPhi=0,this._C=[0,0],this._theta=0,this._delta=0,this._T=0,this._from=t,t[0]!==e[0]||t[1]!==e[1]){var a=Math.PI/180;this._rx=Math.abs(i[0]),this._ry=Math.abs(i[1]),this._sinPhi=Math.sin(s*a),this._cosPhi=Math.cos(s*a);var h=this._cosPhi*(t[0]-e[0])/2+this._sinPhi*(t[1]-e[1])/2,o=-this._sinPhi*(t[0]-e[0])/2+this._cosPhi*(t[1]-e[1])/2,p=0,l=this._rx*this._rx*this._ry*this._ry-this._rx*this._rx*o*o-this._ry*this._ry*h*h;if(l<0){var u=Math.sqrt(1-l/(this._rx*this._rx*this._ry*this._ry));this._rx=this._rx*u,this._ry=this._ry*u,p=0}else p=(r===n?-1:1)*Math.sqrt(l/(this._rx*this._rx*o*o+this._ry*this._ry*h*h));var c=p*this._rx*o/this._ry,f=-p*this._ry*h/this._rx;this._C=[0,0],this._C[0]=this._cosPhi*c-this._sinPhi*f+(t[0]+e[0])/2,this._C[1]=this._sinPhi*c+this._cosPhi*f+(t[1]+e[1])/2,this._theta=this.calculateVectorAngle(1,0,(h-c)/this._rx,(o-f)/this._ry);var d=this.calculateVectorAngle((h-c)/this._rx,(o-f)/this._ry,(-h-c)/this._rx,(-o-f)/this._ry);!n&&d>0?d-=2*Math.PI:n&&d<0&&(d+=2*Math.PI),this._numSegs=Math.ceil(Math.abs(d/(Math.PI/2))),this._delta=d/this._numSegs,this._T=8/3*Math.sin(this._delta/4)*Math.sin(this._delta/4)/Math.sin(this._delta/2)}}return t.prototype.getNextSegment=function(){if(this._segIndex===this._numSegs)return null;var t=Math.cos(this._theta),e=Math.sin(this._theta),i=this._theta+this._delta,s=Math.cos(i),r=Math.sin(i),n=[this._cosPhi*this._rx*s-this._sinPhi*this._ry*r+this._C[0],this._sinPhi*this._rx*s+this._cosPhi*this._ry*r+this._C[1]],a=[this._from[0]+this._T*(-this._cosPhi*this._rx*e-this._sinPhi*this._ry*t),this._from[1]+this._T*(-this._sinPhi*this._rx*e+this._cosPhi*this._ry*t)],h=[n[0]+this._T*(this._cosPhi*this._rx*r+this._sinPhi*this._ry*s),n[1]+this._T*(this._sinPhi*this._rx*r-this._cosPhi*this._ry*s)];return this._theta=i,this._from=[n[0],n[1]],this._segIndex++,{cp1:a,cp2:h,to:n}},t.prototype.calculateVectorAngle=function(t,e,i,s){var r=Math.atan2(e,t),n=Math.atan2(s,i);return n>=r?n-r:2*Math.PI-(r-n)},t}(),p=function(){function t(t,e){this.sets=t,this.closed=e}return t.prototype.fit=function(t){for(var e=[],i=0,s=this.sets;i<s.length;i++){var r=(p=s[i]).length,n=Math.floor(t*r);if(n<5){if(r<=5)continue;n=5}e.push(this.reduce(p,n))}for(var a="",h=0,o=e;h<o.length;h++){for(var p=o[h],l=0;l<p.length;l++){var u=p[l];a+=0===l?"M"+u[0]+","+u[1]:"L"+u[0]+","+u[1]}this.closed&&(a+="z ")}return a},t.prototype.distance=function(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))},t.prototype.reduce=function(t,e){if(t.length<=e)return t;for(var i=t.slice(0);i.length>e;){for(var s=[],r=-1,n=-1,a=1;a<i.length-1;a++){var h=this.distance(i[a-1],i[a]),o=this.distance(i[a],i[a+1]),p=this.distance(i[a-1],i[a+1]),l=(h+o+p)/2,u=Math.sqrt(l*(l-h)*(l-o)*(l-p));s.push(u),(r<0||u<r)&&(r=u,n=a)}if(!(n>0))break;i.splice(n,1)}return i},t}(),l=function(){function t(t,e){this.xi=Number.MAX_VALUE,this.yi=Number.MAX_VALUE,this.px1=t[0],this.py1=t[1],this.px2=e[0],this.py2=e[1],this.a=this.py2-this.py1,this.b=this.px1-this.px2,this.c=this.px2*this.py1-this.px1*this.py2,this._undefined=0===this.a&&0===this.b&&0===this.c}return t.prototype.isUndefined=function(){return this._undefined},t.prototype.intersects=function(t){if(this.isUndefined()||t.isUndefined())return!1;var e=Number.MAX_VALUE,i=Number.MAX_VALUE,s=0,r=0,n=this.a,a=this.b,h=this.c;return Math.abs(a)>1e-5&&(e=-n/a,s=-h/a),Math.abs(t.b)>1e-5&&(i=-t.a/t.b,r=-t.c/t.b),e===Number.MAX_VALUE?i===Number.MAX_VALUE?-h/n==-t.c/t.a&&(this.py1>=Math.min(t.py1,t.py2)&&this.py1<=Math.max(t.py1,t.py2)?(this.xi=this.px1,this.yi=this.py1,!0):this.py2>=Math.min(t.py1,t.py2)&&this.py2<=Math.max(t.py1,t.py2)&&(this.xi=this.px2,this.yi=this.py2,!0)):(this.xi=this.px1,this.yi=i*this.xi+r,!((this.py1-this.yi)*(this.yi-this.py2)<-1e-5||(t.py1-this.yi)*(this.yi-t.py2)<-1e-5)&&(!(Math.abs(t.a)<1e-5)||!((t.px1-this.xi)*(this.xi-t.px2)<-1e-5))):i===Number.MAX_VALUE?(this.xi=t.px1,this.yi=e*this.xi+s,!((t.py1-this.yi)*(this.yi-t.py2)<-1e-5||(this.py1-this.yi)*(this.yi-this.py2)<-1e-5)&&(!(Math.abs(n)<1e-5)||!((this.px1-this.xi)*(this.xi-this.px2)<-1e-5))):e===i?s===r&&(this.px1>=Math.min(t.px1,t.px2)&&this.px1<=Math.max(t.py1,t.py2)?(this.xi=this.px1,this.yi=this.py1,!0):this.px2>=Math.min(t.px1,t.px2)&&this.px2<=Math.max(t.px1,t.px2)&&(this.xi=this.px2,this.yi=this.py2,!0)):(this.xi=(r-s)/(e-i),this.yi=e*this.xi+s,!((this.px1-this.xi)*(this.xi-this.px2)<-1e-5||(t.px1-this.xi)*(this.xi-t.px2)<-1e-5))},t}();var u=function(){function t(t,e,i,s,r,n,a,h){this.deltaX=0,this.hGap=0,this.top=t,this.bottom=e,this.left=i,this.right=s,this.gap=r,this.sinAngle=n,this.tanAngle=h,Math.abs(n)<1e-4?this.pos=i+r:Math.abs(n)>.9999?this.pos=t+r:(this.deltaX=(e-t)*Math.abs(h),this.pos=i-Math.abs(this.deltaX),this.hGap=Math.abs(r/a),this.sLeft=new l([i,e],[i,t]),this.sRight=new l([s,e],[s,t]))}return t.prototype.nextLine=function(){if(Math.abs(this.sinAngle)<1e-4){if(this.pos<this.right){var t=[this.pos,this.top,this.pos,this.bottom];return this.pos+=this.gap,t}}else if(Math.abs(this.sinAngle)>.9999){if(this.pos<this.bottom){t=[this.left,this.pos,this.right,this.pos];return this.pos+=this.gap,t}}else{var e=this.pos-this.deltaX/2,i=this.pos+this.deltaX/2,s=this.bottom,r=this.top;if(this.pos<this.right+this.deltaX){for(;e<this.left&&i<this.left||e>this.right&&i>this.right;)if(this.pos+=this.hGap,e=this.pos-this.deltaX/2,i=this.pos+this.deltaX/2,this.pos>this.right+this.deltaX)return null;var n=new l([e,s],[i,r]);this.sLeft&&n.intersects(this.sLeft)&&(e=n.xi,s=n.yi),this.sRight&&n.intersects(this.sRight)&&(i=n.xi,r=n.yi),this.tanAngle>0&&(e=this.right-(e-this.left),i=this.right-(i-this.left));t=[e,s,i,r];return this.pos+=this.hGap,t}}return null},t}();function c(t){var e=t[0],i=t[1];return Math.sqrt(Math.pow(e[0]-i[0],2)+Math.pow(e[1]-i[1],2))}function f(t,e){for(var i=[],s=new l([t[0],t[1]],[t[2],t[3]]),r=0;r<e.length;r++){var n=new l(e[r],e[(r+1)%e.length]);s.intersects(n)&&i.push([s.xi,s.yi])}return i}function d(t,e,i,s,r,n,a){return[-i*n-s*r+i+n*t+r*e,a*(i*r-s*n)+s+-a*r*t+a*n*e]}function y(t,e){var i=[];if(t&&t.length){for(var s=t[0][0],r=t[0][0],n=t[0][1],a=t[0][1],h=1;h<t.length;h++)s=Math.min(s,t[h][0]),r=Math.max(r,t[h][0]),n=Math.min(n,t[h][1]),a=Math.max(a,t[h][1]);var o=e.hachureAngle,p=e.hachureGap;p<0&&(p=4*e.strokeWidth),p=Math.max(p,.1);for(var l=o%180*(Math.PI/180),c=Math.cos(l),d=Math.sin(l),y=Math.tan(l),v=new u(n-1,a+1,s-1,r+1,p,d,c,y),g=void 0;null!=(g=v.nextLine());){var b=f(g,t);for(h=0;h<b.length;h++)if(h<b.length-1){var M=b[h],m=b[h+1];i.push([M,m])}}}return i}function v(t,e,i,s,r,n){var a=[],h=Math.abs(s/2),o=Math.abs(r/2);h+=t.randOffset(.05*h,n),o+=t.randOffset(.05*o,n);var p=n.hachureAngle,l=n.hachureGap;l<=0&&(l=4*n.strokeWidth);var u=n.fillWeight;u<0&&(u=n.strokeWidth/2);for(var c=p%180*(Math.PI/180),f=Math.tan(c),y=o/h,v=Math.sqrt(y*f*y*f+1),g=y*f/v,b=1/v,M=l/(h*o/Math.sqrt(o*b*(o*b)+h*g*(h*g))/h),m=Math.sqrt(h*h-(e-h+M)*(e-h+M)),_=e-h+M;_<e+h;_+=M){var x=d(_,i-(m=Math.sqrt(h*h-(e-_)*(e-_))),e,i,g,b,y),w=d(_,i+m,e,i,g,b,y);a.push([x,w])}return a}var g=function(){function t(t){this.helper=t}return t.prototype.fillPolygon=function(t,e){return this._fillPolygon(t,e)},t.prototype.fillEllipse=function(t,e,i,s,r){return this._fillEllipse(t,e,i,s,r)},t.prototype.fillArc=function(t,e,i,s,r,n,a){return null},t.prototype._fillPolygon=function(t,e,i){void 0===i&&(i=!1);var s=y(t,e);return{type:"fillSketch",ops:this.renderLines(s,e,i)}},t.prototype._fillEllipse=function(t,e,i,s,r,n){void 0===n&&(n=!1);var a=v(this.helper,t,e,i,s,r);return{type:"fillSketch",ops:this.renderLines(a,r,n)}},t.prototype.renderLines=function(t,e,i){for(var s=[],r=null,n=0,a=t;n<a.length;n++){var h=a[n];s=s.concat(this.helper.doubleLineOps(h[0][0],h[0][1],h[1][0],h[1][1],e)),i&&r&&(s=s.concat(this.helper.doubleLineOps(r[0],r[1],h[0][0],h[0][1],e))),r=h[1]}return s},t}(),b=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.fillPolygon=function(t,e){return this._fillPolygon(t,e,!0)},i.prototype.fillEllipse=function(t,e,i,s,r){return this._fillEllipse(t,e,i,s,r,!0)},i}(g),M=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.fillPolygon=function(t,e){var i=this._fillPolygon(t,e),s=Object.assign({},e,{hachureAngle:e.hachureAngle+90}),r=this._fillPolygon(t,s);return i.ops=i.ops.concat(r.ops),i},i.prototype.fillEllipse=function(t,e,i,s,r){var n=this._fillEllipse(t,e,i,s,r),a=Object.assign({},r,{hachureAngle:r.hachureAngle+90}),h=this._fillEllipse(t,e,i,s,a);return n.ops=n.ops.concat(h.ops),n},i}(g),m=function(){function t(t){this.helper=t}return t.prototype.fillPolygon=function(t,e){var i=y(t,e=Object.assign({},e,{curveStepCount:4,hachureAngle:0}));return this.dotsOnLines(i,e)},t.prototype.fillEllipse=function(t,e,i,s,r){r=Object.assign({},r,{curveStepCount:4,hachureAngle:0});var n=v(this.helper,t,e,i,s,r);return this.dotsOnLines(n,r)},t.prototype.fillArc=function(t,e,i,s,r,n,a){return null},t.prototype.dotsOnLines=function(t,e){var i=[],s=e.hachureGap;s<0&&(s=4*e.strokeWidth),s=Math.max(s,.1);var r=e.fillWeight;r<0&&(r=e.strokeWidth/2);for(var n=0,a=t;n<a.length;n++)for(var h=a[n],o=c(h)/s,p=Math.ceil(o)-1,l=Math.atan((h[1][1]-h[0][1])/(h[1][0]-h[0][0])),u=0;u<p;u++){var f=s*(u+1),d=f*Math.sin(l),y=f*Math.cos(l),v=[h[0][0]-y,h[0][1]+d],g=this.helper.randOffsetWithRange(v[0]-s/4,v[0]+s/4,e),b=this.helper.randOffsetWithRange(v[1]-s/4,v[1]+s/4,e),M=this.helper.ellipse(g,b,r,r,e);i=i.concat(M.ops)}return{type:"fillSketch",ops:i}},t}(),_=function(){function t(t){this.helper=t}return t.prototype.fillPolygon=function(t,e){var i=[Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER],s=[Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER];t.forEach(function(t){i[0]=Math.min(i[0],t[0]),i[1]=Math.max(i[1],t[0]),s[0]=Math.min(s[0],t[1]),s[1]=Math.max(s[1],t[1])});var r=function(t){for(var e=0,i=0,s=0,r=0;r<t.length;r++){var n=t[r],a=r===t.length-1?t[0]:t[r+1];e+=n[0]*a[1]-a[0]*n[1]}for(e/=2,r=0;r<t.length;r++)n=t[r],a=r===t.length-1?t[0]:t[r+1],i+=(n[0]+a[0])*(n[0]*a[1]-a[0]*n[1]),s+=(n[1]+a[1])*(n[0]*a[1]-a[0]*n[1]);return[i/(6*e),s/(6*e)]}(t),n=Math.max(Math.sqrt(Math.pow(r[0]-i[0],2)+Math.pow(r[1]-s[0],2)),Math.sqrt(Math.pow(r[0]-i[1],2)+Math.pow(r[1]-s[1],2))),a=e.hachureGap>0?e.hachureGap:4*e.strokeWidth,h=[];if(t.length>2)for(var o=0;o<t.length;o++)o===t.length-1?h.push([t[o],t[0]]):h.push([t[o],t[o+1]]);var p=[],l=Math.max(1,Math.PI*n/a),u=function(t){var e=t*Math.PI/l,a=[r,[r[0]+n*Math.cos(e),r[1]+n*Math.sin(e)]];h.forEach(function(t){var e,r,n,h,o,l,u,c,f,d=(r=a,n=(e=t)[1][1]-e[0][1],h=e[0][0]-e[1][0],o=n*e[0][0]+h*e[0][1],l=r[1][1]-r[0][1],u=r[0][0]-r[1][0],c=l*r[0][0]+u*r[0][1],(f=n*u-l*h)?[Math.round((u*o-h*c)/f),Math.round((n*c-l*o)/f)]:null);d&&d[0]>=i[0]&&d[0]<=i[1]&&d[1]>=s[0]&&d[1]<=s[1]&&p.push(d)})};for(o=0;o<l;o++)u(o);p=this.removeDuplocatePoints(p);var c=this.createLinesFromCenter(r,p);return{type:"fillSketch",ops:this.drawLines(c,e)}},t.prototype.fillEllipse=function(t,e,i,s,r){return this.fillArcSegment(t,e,i,s,0,2*Math.PI,r)},t.prototype.fillArc=function(t,e,i,s,r,n,a){return this.fillArcSegment(t,e,i,s,r,n,a)},t.prototype.fillArcSegment=function(t,e,i,s,r,n,a){var h=[t,e],o=i/2,p=s/2,l=Math.max(i/2,s/2),u=a.hachureGap;u<0&&(u=4*a.strokeWidth);for(var c=Math.max(1,Math.abs(n-r)*l/u),f=[],d=0;d<c;d++){var y=d*((n-r)/c)+r,v=l*Math.cos(y),g=l*Math.sin(y),b=Math.sqrt(o*o*g*g+p*p*v*v),M=o*p*v/b,m=o*p*g/b;f.push([h[0]+M,h[1]+m])}f=this.removeDuplocatePoints(f);var _=this.createLinesFromCenter(h,f);return{type:"fillSketch",ops:this.drawLines(_,a)}},t.prototype.drawLines=function(t,e){var i=this,s=[];return t.forEach(function(t){var r=t[0],n=t[1];s=s.concat(i.helper.doubleLineOps(r[0],r[1],n[0],n[1],e))}),s},t.prototype.createLinesFromCenter=function(t,e){return e.map(function(e){return[t,e]})},t.prototype.removeDuplocatePoints=function(t){var e=new Set;return t.filter(function(t){var i=t.join(",");return!e.has(i)&&(e.add(i),!0)})},t}(),x=function(){function t(t){this.helper=t}return t.prototype.fillPolygon=function(t,e){var i=y(t,e);return{type:"fillSketch",ops:this.dashedLine(i,e)}},t.prototype.fillEllipse=function(t,e,i,s,r){var n=v(this.helper,t,e,i,s,r);return{type:"fillSketch",ops:this.dashedLine(n,r)}},t.prototype.fillArc=function(t,e,i,s,r,n,a){return null},t.prototype.dashedLine=function(t,e){var i=this,s=e.dashOffset<0?e.hachureGap<0?4*e.strokeWidth:e.hachureGap:e.dashOffset,r=e.dashGap<0?e.hachureGap<0?4*e.strokeWidth:e.hachureGap:e.dashGap,n=[];return t.forEach(function(t){var a=c(t),h=Math.floor(a/(s+r)),o=(a+r-h*(s+r))/2,p=t[0],l=t[1];p[0]>l[0]&&(p=t[1],l=t[0]);for(var u=Math.atan((l[1]-p[1])/(l[0]-p[0])),f=0;f<h;f++){var d=f*(s+r),y=d+s,v=[p[0]+d*Math.cos(u)+o*Math.cos(u),p[1]+d*Math.sin(u)+o*Math.sin(u)],g=[p[0]+y*Math.cos(u)+o*Math.cos(u),p[1]+y*Math.sin(u)+o*Math.sin(u)];n=n.concat(i.helper.doubleLineOps(v[0],v[1],g[0],g[1],e))}}),n},t}(),w={};function P(t,e){var i=t.fillStyle||"hachure";if(!w[i])switch(i){case"zigzag":w[i]||(w[i]=new b(e));break;case"cross-hatch":w[i]||(w[i]=new M(e));break;case"dots":w[i]||(w[i]=new m(e));break;case"starburst":w[i]||(w[i]=new _(e));break;case"dashed":w[i]||(w[i]=new x(e));break;case"hachure":default:w[i="hachure"]||(w[i]=new g(e))}return w[i]}var k={randOffset:function(t,e){return W(t,e)},randOffsetWithRange:function(t,e,i){return R(t,e,i)},ellipse:T,doubleLineOps:function(t,e,i,s,r){return I(t,e,i,s,r)}};function A(t,e,i,s,r){return{type:"path",ops:I(t,e,i,s,r)}}function S(t,e,i){var s=(t||[]).length;if(s>2){for(var r=[],n=0;n<s-1;n++)r=r.concat(I(t[n][0],t[n][1],t[n+1][0],t[n+1][1],i));return e&&(r=r.concat(I(t[s-1][0],t[s-1][1],t[0][0],t[0][1],i))),{type:"path",ops:r}}return 2===s?A(t[0][0],t[0][1],t[1][0],t[1][1],i):{type:"path",ops:[]}}function O(t,e,i,s,r){return function(t,e){return S(t,!0,e)}([[t,e],[t+i,e],[t+i,e+s],[t,e+s]],r)}function E(t,e){var i=q(t,1*(1+.2*e.roughness),e),s=q(t,1.5*(1+.22*e.roughness),e);return{type:"path",ops:i.concat(s)}}function T(t,e,i,s,r){var n=2*Math.PI/r.curveStepCount,a=Math.abs(i/2),h=Math.abs(s/2),o=j(n,t,e,a+=W(.05*a,r),h+=W(.05*h,r),1,n*R(.1,R(.4,1,r),r),r),p=j(n,t,e,a,h,1.5,0,r);return{type:"path",ops:o.concat(p)}}function C(t,e,i,s,r,n,a,h,o){var p=t,l=e,u=Math.abs(i/2),c=Math.abs(s/2);u+=W(.01*u,o),c+=W(.01*c,o);for(var f=r,d=n;f<0;)f+=2*Math.PI,d+=2*Math.PI;d-f>2*Math.PI&&(f=0,d=2*Math.PI);var y=2*Math.PI/o.curveStepCount,v=Math.min(y/2,(d-f)/2),g=G(v,p,l,u,c,f,d,1,o),b=G(v,p,l,u,c,f,d,1.5,o),M=g.concat(b);return a&&(h?M=(M=M.concat(I(p,l,p+u*Math.cos(f),l+c*Math.sin(f),o))).concat(I(p,l,p+u*Math.cos(d),l+c*Math.sin(d),o)):(M.push({op:"lineTo",data:[p,l]}),M.push({op:"lineTo",data:[p+u*Math.cos(f),l+c*Math.sin(f)]}))),{type:"path",ops:M}}function L(t,e){var i=[];if(t.length){var s=e.maxRandomnessOffset||0,r=t.length;if(r>2){i.push({op:"move",data:[t[0][0]+W(s,e),t[0][1]+W(s,e)]});for(var n=1;n<r;n++)i.push({op:"lineTo",data:[t[n][0]+W(s,e),t[n][1]+W(s,e)]})}}return{type:"fillPath",ops:i}}function N(t,e){return P(e,k).fillPolygon(t,e)}function R(t,e,i){return i.roughness*(Math.random()*(e-t)+t)}function W(t,e){return R(-t,t,e)}function I(t,e,i,s,r){var n=D(t,e,i,s,r,!0,!1),a=D(t,e,i,s,r,!0,!0);return n.concat(a)}function D(t,e,i,s,r,n,a){var h=Math.pow(t-i,2)+Math.pow(e-s,2),o=r.maxRandomnessOffset||0;o*o*100>h&&(o=Math.sqrt(h)/10);var p=o/2,l=.2+.2*Math.random(),u=r.bowing*r.maxRandomnessOffset*(s-e)/200,c=r.bowing*r.maxRandomnessOffset*(t-i)/200;u=W(u,r),c=W(c,r);var f=[],d=function(){return W(p,r)},y=function(){return W(o,r)};return n&&(a?f.push({op:"move",data:[t+d(),e+d()]}):f.push({op:"move",data:[t+W(o,r),e+W(o,r)]})),a?f.push({op:"bcurveTo",data:[u+t+(i-t)*l+d(),c+e+(s-e)*l+d(),u+t+2*(i-t)*l+d(),c+e+2*(s-e)*l+d(),i+d(),s+d()]}):f.push({op:"bcurveTo",data:[u+t+(i-t)*l+y(),c+e+(s-e)*l+y(),u+t+2*(i-t)*l+y(),c+e+2*(s-e)*l+y(),i+y(),s+y()]}),f}function q(t,e,i){var s=[];s.push([t[0][0]+W(e,i),t[0][1]+W(e,i)]),s.push([t[0][0]+W(e,i),t[0][1]+W(e,i)]);for(var r=1;r<t.length;r++)s.push([t[r][0]+W(e,i),t[r][1]+W(e,i)]),r===t.length-1&&s.push([t[r][0]+W(e,i),t[r][1]+W(e,i)]);return z(s,null,i)}function z(t,e,i){var s=t.length,r=[];if(s>3){var n=[],a=1-i.curveTightness;r.push({op:"move",data:[t[1][0],t[1][1]]});for(var h=1;h+2<s;h++){var o=t[h];n[0]=[o[0],o[1]],n[1]=[o[0]+(a*t[h+1][0]-a*t[h-1][0])/6,o[1]+(a*t[h+1][1]-a*t[h-1][1])/6],n[2]=[t[h+1][0]+(a*t[h][0]-a*t[h+2][0])/6,t[h+1][1]+(a*t[h][1]-a*t[h+2][1])/6],n[3]=[t[h+1][0],t[h+1][1]],r.push({op:"bcurveTo",data:[n[1][0],n[1][1],n[2][0],n[2][1],n[3][0],n[3][1]]})}if(e&&2===e.length){var p=i.maxRandomnessOffset;r.push({op:"lineTo",data:[e[0]+W(p,i),e[1]+W(p,i)]})}}else 3===s?(r.push({op:"move",data:[t[1][0],t[1][1]]}),r.push({op:"bcurveTo",data:[t[1][0],t[1][1],t[2][0],t[2][1],t[2][0],t[2][1]]})):2===s&&(r=r.concat(I(t[0][0],t[0][1],t[1][0],t[1][1],i)));return r}function j(t,e,i,s,r,n,a,h){var o=W(.5,h)-Math.PI/2,p=[];p.push([W(n,h)+e+.9*s*Math.cos(o-t),W(n,h)+i+.9*r*Math.sin(o-t)]);for(var l=o;l<2*Math.PI+o-.01;l+=t)p.push([W(n,h)+e+s*Math.cos(l),W(n,h)+i+r*Math.sin(l)]);return p.push([W(n,h)+e+s*Math.cos(o+2*Math.PI+.5*a),W(n,h)+i+r*Math.sin(o+2*Math.PI+.5*a)]),p.push([W(n,h)+e+.98*s*Math.cos(o+a),W(n,h)+i+.98*r*Math.sin(o+a)]),p.push([W(n,h)+e+.9*s*Math.cos(o+.5*a),W(n,h)+i+.9*r*Math.sin(o+.5*a)]),z(p,null,h)}function G(t,e,i,s,r,n,a,h,o){var p=n+W(.1,o),l=[];l.push([W(h,o)+e+.9*s*Math.cos(p-t),W(h,o)+i+.9*r*Math.sin(p-t)]);for(var u=p;u<=a;u+=t)l.push([W(h,o)+e+s*Math.cos(u),W(h,o)+i+r*Math.sin(u)]);return l.push([e+s*Math.cos(a),i+r*Math.sin(a)]),l.push([e+s*Math.cos(a),i+r*Math.sin(a)]),z(l,null,o)}function B(t,e,i,s,r,n,a,h){for(var o=[],p=[h.maxRandomnessOffset||1,(h.maxRandomnessOffset||1)+.5],l=[0,0],u=0;u<2;u++)0===u?o.push({op:"move",data:[a.x,a.y]}):o.push({op:"move",data:[a.x+W(p[0],h),a.y+W(p[0],h)]}),l=[r+W(p[u],h),n+W(p[u],h)],o.push({op:"bcurveTo",data:[t+W(p[u],h),e+W(p[u],h),i+W(p[u],h),s+W(p[u],h),l[0],l[1]]});return a.setPosition(l[0],l[1]),o}function X(t,e,i,s){var r=[];switch(e.key){case"M":case"m":var n="m"===e.key;if(e.data.length>=2){var a=+e.data[0],h=+e.data[1];n&&(a+=t.x,h+=t.y);var p=1*(s.maxRandomnessOffset||0);a+=W(p,s),h+=W(p,s),t.setPosition(a,h),r.push({op:"move",data:[a,h]})}break;case"L":case"l":n="l"===e.key;if(e.data.length>=2){a=+e.data[0],h=+e.data[1];n&&(a+=t.x,h+=t.y),r=r.concat(I(t.x,t.y,a,h,s)),t.setPosition(a,h)}break;case"H":case"h":n="h"===e.key;if(e.data.length){a=+e.data[0];n&&(a+=t.x),r=r.concat(I(t.x,t.y,a,t.y,s)),t.setPosition(a,t.y)}break;case"V":case"v":n="v"===e.key;if(e.data.length){h=+e.data[0];n&&(h+=t.y),r=r.concat(I(t.x,t.y,t.x,h,s)),t.setPosition(t.x,h)}break;case"Z":case"z":t.first&&(r=r.concat(I(t.x,t.y,t.first[0],t.first[1],s)),t.setPosition(t.first[0],t.first[1]),t.first=null);break;case"C":case"c":n="c"===e.key;if(e.data.length>=6){var l=+e.data[0],u=+e.data[1],c=+e.data[2],f=+e.data[3];a=+e.data[4],h=+e.data[5];n&&(l+=t.x,c+=t.x,a+=t.x,u+=t.y,f+=t.y,h+=t.y);var d=B(l,u,c,f,a,h,t,s);r=r.concat(d),t.bezierReflectionPoint=[a+(a-c),h+(h-f)]}break;case"S":case"s":n="s"===e.key;if(e.data.length>=4){c=+e.data[0],f=+e.data[1],a=+e.data[2],h=+e.data[3];n&&(c+=t.x,a+=t.x,f+=t.y,h+=t.y);l=c,u=f;var y=null;"c"!==(M=i?i.key:"")&&"C"!==M&&"s"!==M&&"S"!==M||(y=t.bezierReflectionPoint),y&&(l=y[0],u=y[1]);d=B(l,u,c,f,a,h,t,s);r=r.concat(d),t.bezierReflectionPoint=[a+(a-c),h+(h-f)]}break;case"Q":case"q":n="q"===e.key;if(e.data.length>=4){l=+e.data[0],u=+e.data[1],a=+e.data[2],h=+e.data[3];n&&(l+=t.x,a+=t.x,u+=t.y,h+=t.y);var v=1*(1+.2*s.roughness),g=1.5*(1+.22*s.roughness);r.push({op:"move",data:[t.x+W(v,s),t.y+W(v,s)]});var b=[a+W(v,s),h+W(v,s)];r.push({op:"qcurveTo",data:[l+W(v,s),u+W(v,s),b[0],b[1]]}),r.push({op:"move",data:[t.x+W(g,s),t.y+W(g,s)]}),b=[a+W(g,s),h+W(g,s)],r.push({op:"qcurveTo",data:[l+W(g,s),u+W(g,s),b[0],b[1]]}),t.setPosition(b[0],b[1]),t.quadReflectionPoint=[a+(a-l),h+(h-u)]}break;case"T":case"t":n="t"===e.key;if(e.data.length>=2){a=+e.data[0],h=+e.data[1];n&&(a+=t.x,h+=t.y);var M;l=a,u=h,y=null;"q"!==(M=i?i.key:"")&&"Q"!==M&&"t"!==M&&"T"!==M||(y=t.quadReflectionPoint),y&&(l=y[0],u=y[1]);v=1*(1+.2*s.roughness),g=1.5*(1+.22*s.roughness);r.push({op:"move",data:[t.x+W(v,s),t.y+W(v,s)]});b=[a+W(v,s),h+W(v,s)];r.push({op:"qcurveTo",data:[l+W(v,s),u+W(v,s),b[0],b[1]]}),r.push({op:"move",data:[t.x+W(g,s),t.y+W(g,s)]}),b=[a+W(g,s),h+W(g,s)],r.push({op:"qcurveTo",data:[l+W(g,s),u+W(g,s),b[0],b[1]]}),t.setPosition(b[0],b[1]),t.quadReflectionPoint=[a+(a-l),h+(h-u)]}break;case"A":case"a":n="a"===e.key;if(e.data.length>=7){var m=+e.data[0],_=+e.data[1],x=+e.data[2],w=+e.data[3],P=+e.data[4];a=+e.data[5],h=+e.data[6];if(n&&(a+=t.x,h+=t.y),a===t.x&&h===t.y)break;if(0===m||0===_)r=r.concat(I(t.x,t.y,a,h,s)),t.setPosition(a,h);else for(var k=0;k<1;k++)for(var A=new o([t.x,t.y],[a,h],[m,_],x,!!w,!!P),S=A.getNextSegment();S;){d=B(S.cp1[0],S.cp1[1],S.cp2[0],S.cp2[1],S.to[0],S.to[1],t,s);r=r.concat(d),S=A.getNextSegment()}}}return r}var U=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.line=function(t,e,i,s,r){var n=this._options(r);return this._drawable("line",[A(t,e,i,s,n)],n)},i.prototype.rectangle=function(t,e,i,s,r){var n=this._options(r),a=[];if(n.fill){var h=[[t,e],[t+i,e],[t+i,e+s],[t,e+s]];"solid"===n.fillStyle?a.push(L(h,n)):a.push(N(h,n))}return a.push(O(t,e,i,s,n)),this._drawable("rectangle",a,n)},i.prototype.ellipse=function(t,e,i,s,r){var n=this._options(r),a=[];if(n.fill)if("solid"===n.fillStyle){var h=T(t,e,i,s,n);h.type="fillPath",a.push(h)}else a.push(function(t,e,i,s,r){return P(r,k).fillEllipse(t,e,i,s,r)}(t,e,i,s,n));return a.push(T(t,e,i,s,n)),this._drawable("ellipse",a,n)},i.prototype.circle=function(t,e,i,s){var r=this.ellipse(t,e,i,i,s);return r.shape="circle",r},i.prototype.linearPath=function(t,e){var i=this._options(e);return this._drawable("linearPath",[S(t,!1,i)],i)},i.prototype.arc=function(t,e,i,s,r,n,a,h){void 0===a&&(a=!1);var o=this._options(h),p=[];if(a&&o.fill)if("solid"===o.fillStyle){var l=C(t,e,i,s,r,n,!0,!1,o);l.type="fillPath",p.push(l)}else p.push(function(t,e,i,s,r,n,a){var h=P(a,k).fillArc(t,e,i,s,r,n,a);if(h)return h;var o=t,p=e,l=Math.abs(i/2),u=Math.abs(s/2);l+=W(.01*l,a),u+=W(.01*u,a);for(var c=r,f=n;c<0;)c+=2*Math.PI,f+=2*Math.PI;f-c>2*Math.PI&&(c=0,f=2*Math.PI);for(var d=(f-c)/a.curveStepCount,y=[],v=c;v<=f;v+=d)y.push([o+l*Math.cos(v),p+u*Math.sin(v)]);return y.push([o+l*Math.cos(f),p+u*Math.sin(f)]),y.push([o,p]),N(y,a)}(t,e,i,s,r,n,o));return p.push(C(t,e,i,s,r,n,a,!0,o)),this._drawable("arc",p,o)},i.prototype.curve=function(t,e){var i=this._options(e);return this._drawable("curve",[E(t,i)],i)},i.prototype.polygon=function(t,e){var i=this._options(e),s=[];if(i.fill)if("solid"===i.fillStyle)s.push(L(t,i));else{var r=this.computePolygonSize(t),n=N([[0,0],[r[0],0],[r[0],r[1]],[0,r[1]]],i);n.type="path2Dpattern",n.size=r,n.path=this.polygonPath(t),s.push(n)}return s.push(S(t,!0,i)),this._drawable("polygon",s,i)},i.prototype.path=function(t,e){var i=this._options(e),s=[];if(!t)return this._drawable("path",s,i);if(i.fill)if("solid"===i.fillStyle){var r={type:"path2Dfill",path:t,ops:[]};s.push(r)}else{var n=this.computePathSize(t);(r=N([[0,0],[n[0],0],[n[0],n[1]],[0,n[1]]],i)).type="path2Dpattern",r.size=n,r.path=t,s.push(r)}return s.push(function(t,e){t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");var i=new h(t);if(e.simplification){var s=new p(i.linearPoints,i.closed).fit(e.simplification);i=new h(s)}for(var r=[],n=i.segments||[],a=0;a<n.length;a++){var o=X(i,n[a],a>0?n[a-1]:null,e);o&&o.length&&(r=r.concat(o))}return{type:"path",ops:r}}(t,i)),this._drawable("path",s,i)},i}(s),V="undefined"!=typeof document,F=function(t){function i(e,i){var s=t.call(this,e)||this;return s.gen=new U(i||null,s.canvas),s}return e(i,t),Object.defineProperty(i.prototype,"generator",{get:function(){return this.gen},enumerable:!0,configurable:!0}),i.prototype.getDefaultOptions=function(){return this.gen.defaultOptions},i.prototype.line=function(t,e,i,s,r){var n=this.gen.line(t,e,i,s,r);return this.draw(n),n},i.prototype.rectangle=function(t,e,i,s,r){var n=this.gen.rectangle(t,e,i,s,r);return this.draw(n),n},i.prototype.ellipse=function(t,e,i,s,r){var n=this.gen.ellipse(t,e,i,s,r);return this.draw(n),n},i.prototype.circle=function(t,e,i,s){var r=this.gen.circle(t,e,i,s);return this.draw(r),r},i.prototype.linearPath=function(t,e){var i=this.gen.linearPath(t,e);return this.draw(i),i},i.prototype.polygon=function(t,e){var i=this.gen.polygon(t,e);return this.draw(i),i},i.prototype.arc=function(t,e,i,s,r,n,a,h){void 0===a&&(a=!1);var o=this.gen.arc(t,e,i,s,r,n,a,h);return this.draw(o),o},i.prototype.curve=function(t,e){var i=this.gen.curve(t,e);return this.draw(i),i},i.prototype.path=function(t,e){var i=this.gen.path(t,e);return this.draw(i),i},i}(function(){function t(t){this.canvas=t,this.ctx=this.canvas.getContext("2d")}return t.prototype.draw=function(t){for(var e=t.sets||[],i=t.options||this.getDefaultOptions(),s=this.ctx,r=0,n=e;r<n.length;r++){var a=n[r];switch(a.type){case"path":s.save(),s.strokeStyle=i.stroke,s.lineWidth=i.strokeWidth,this._drawToContext(s,a),s.restore();break;case"fillPath":s.save(),s.fillStyle=i.fill||"",this._drawToContext(s,a),s.restore();break;case"fillSketch":this.fillSketch(s,a,i);break;case"path2Dfill":this.ctx.save(),this.ctx.fillStyle=i.fill||"";var h=new Path2D(a.path);this.ctx.fill(h),this.ctx.restore();break;case"path2Dpattern":var o=this.canvas.ownerDocument||V&&document;if(o){var p=a.size,l=o.createElement("canvas"),u=l.getContext("2d"),c=this.computeBBox(a.path);c&&(c.width||c.height)?(l.width=this.canvas.width,l.height=this.canvas.height,u.translate(c.x||0,c.y||0)):(l.width=p[0],l.height=p[1]),this.fillSketch(u,a,i),this.ctx.save(),this.ctx.fillStyle=this.ctx.createPattern(l,"repeat");h=new Path2D(a.path);this.ctx.fill(h),this.ctx.restore()}else console.error("Cannot render path2Dpattern. No defs/document defined.")}}},t.prototype.computeBBox=function(t){if(V)try{var e="http://www.w3.org/2000/svg",i=document.createElementNS(e,"svg");i.setAttribute("width","0"),i.setAttribute("height","0");var s=self.document.createElementNS(e,"path");s.setAttribute("d",t),i.appendChild(s),document.body.appendChild(i);var r=s.getBBox();return document.body.removeChild(i),r}catch(t){}return null},t.prototype.fillSketch=function(t,e,i){var s=i.fillWeight;s<0&&(s=i.strokeWidth/2),t.save(),t.strokeStyle=i.fill||"",t.lineWidth=s,this._drawToContext(t,e),t.restore()},t.prototype._drawToContext=function(t,e){t.beginPath();for(var i=0,s=e.ops;i<s.length;i++){var r=s[i],n=r.data;switch(r.op){case"move":t.moveTo(n[0],n[1]);break;case"bcurveTo":t.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5]);break;case"qcurveTo":t.quadraticCurveTo(n[0],n[1],n[2],n[3]);break;case"lineTo":t.lineTo(n[0],n[1])}}"fillPath"===e.type?t.fill():t.stroke()},t}()),Q="undefined"!=typeof document,Z=function(t){function i(e,i){var s=t.call(this,e)||this;return s.gen=new U(i||null,s.svg),s}return e(i,t),Object.defineProperty(i.prototype,"generator",{get:function(){return this.gen},enumerable:!0,configurable:!0}),i.prototype.getDefaultOptions=function(){return this.gen.defaultOptions},i.prototype.opsToPath=function(t){return this.gen.opsToPath(t)},i.prototype.line=function(t,e,i,s,r){var n=this.gen.line(t,e,i,s,r);return this.draw(n)},i.prototype.rectangle=function(t,e,i,s,r){var n=this.gen.rectangle(t,e,i,s,r);return this.draw(n)},i.prototype.ellipse=function(t,e,i,s,r){var n=this.gen.ellipse(t,e,i,s,r);return this.draw(n)},i.prototype.circle=function(t,e,i,s){var r=this.gen.circle(t,e,i,s);return this.draw(r)},i.prototype.linearPath=function(t,e){var i=this.gen.linearPath(t,e);return this.draw(i)},i.prototype.polygon=function(t,e){var i=this.gen.polygon(t,e);return this.draw(i)},i.prototype.arc=function(t,e,i,s,r,n,a,h){void 0===a&&(a=!1);var o=this.gen.arc(t,e,i,s,r,n,a,h);return this.draw(o)},i.prototype.curve=function(t,e){var i=this.gen.curve(t,e);return this.draw(i)},i.prototype.path=function(t,e){var i=this.gen.path(t,e);return this.draw(i)},i}(function(){function t(t){this.svg=t}return Object.defineProperty(t.prototype,"defs",{get:function(){var t=this.svg.ownerDocument||Q&&document;if(t&&!this._defs){var e=t.createElementNS("http://www.w3.org/2000/svg","defs");this.svg.firstChild?this.svg.insertBefore(e,this.svg.firstChild):this.svg.appendChild(e),this._defs=e}return this._defs||null},enumerable:!0,configurable:!0}),t.prototype.draw=function(t){for(var e=t.sets||[],i=t.options||this.getDefaultOptions(),s=this.svg.ownerDocument||window.document,r=s.createElementNS("http://www.w3.org/2000/svg","g"),n=0,a=e;n<a.length;n++){var h=a[n],o=null;switch(h.type){case"path":(o=s.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",this.opsToPath(h)),o.style.stroke=i.stroke,o.style.strokeWidth=i.strokeWidth+"",o.style.fill="none";break;case"fillPath":(o=s.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",this.opsToPath(h)),o.style.stroke="none",o.style.strokeWidth="0",o.style.fill=i.fill||null;break;case"fillSketch":o=this.fillSketch(s,h,i);break;case"path2Dfill":(o=s.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",h.path||""),o.style.stroke="none",o.style.strokeWidth="0",o.style.fill=i.fill||null;break;case"path2Dpattern":if(this.defs){var p=h.size,l=s.createElementNS("http://www.w3.org/2000/svg","pattern"),u="rough-"+Math.floor(Math.random()*(Number.MAX_SAFE_INTEGER||999999));l.setAttribute("id",u),l.setAttribute("x","0"),l.setAttribute("y","0"),l.setAttribute("width","1"),l.setAttribute("height","1"),l.setAttribute("height","1"),l.setAttribute("viewBox","0 0 "+Math.round(p[0])+" "+Math.round(p[1])),l.setAttribute("patternUnits","objectBoundingBox");var c=this.fillSketch(s,h,i);l.appendChild(c),this.defs.appendChild(l),(o=s.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",h.path||""),o.style.stroke="none",o.style.strokeWidth="0",o.style.fill="url(#"+u+")"}else console.error("Cannot render path2Dpattern. No defs/document defined.")}o&&r.appendChild(o)}return r},t.prototype.fillSketch=function(t,e,i){var s=i.fillWeight;s<0&&(s=i.strokeWidth/2);var r=t.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttribute("d",this.opsToPath(e)),r.style.stroke=i.fill||null,r.style.strokeWidth=s+"",r.style.fill="none",r},t}());return{canvas:function(t,e){return new F(t,e)},svg:function(t,e){return new Z(t,e)},generator:function(t,e){return new U(t,e)}}});
